<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WalletConnect v2 Connect</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://unpkg.com/@walletconnect/ethereum-provider@2.15.1/dist/index.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js"></script>
<style>
  body { background:#020617; color:white; font-family:system-ui; display:flex; justify-content:center; align-items:center; min-height:100vh; margin:0; }
  .card { background:#020617; border:1px solid #1e293b; padding:28px; border-radius:16px; width:100%; max-width:420px; text-align:center; }
  button { width:100%; padding:14px; margin-top:14px; border-radius:12px; border:none; font-weight:600; cursor:pointer; }
  .primary { background:#22c55e; color:#020617; }
  .danger { background:#ef4444; color:white; }
  .success { color:#22c55e; margin-top:12px; font-weight:600; }
  .error { color:#ef4444; margin-top:12px; font-weight:600; }
</style>
</head>
<body>

<div class="card">
  <h2>WalletConnect v2</h2>
  <button id="connectBtn" class="primary">Connect Wallet</button>
  <button id="disconnectBtn" class="danger" style="display:none;">Disconnect</button>
  <div id="status"></div>
</div>

<script>
const projectId = "962425907914a3e80a7d8e7288b23f62";
let provider;
let signer;
let address;
let ethersProvider;

const connectBtn = document.getElementById("connectBtn");
const disconnectBtn = document.getElementById("disconnectBtn");
const statusEl = document.getElementById("status");

async function connectWallet() {
  try {
    statusEl.innerHTML = "Connecting...";
    
    provider = await window.EthereumProvider.init({
      projectId,
      chains: [1, 11155111], // mainnet + sepolia
      showQrModal: true
    });

    await provider.connect();

    ethersProvider = new ethers.BrowserProvider(provider);
    signer = await ethersProvider.getSigner();
    address = await signer.getAddress();

    statusEl.innerHTML = `<div class="success">âœ” Connected: ${address.slice(0,6)}...${address.slice(-4)}</div>`;
    connectBtn.style.display = "none";
    disconnectBtn.style.display = "block";

    provider.on("disconnect", () => {
      disconnectWallet();
    });

  } catch (err) {
    console.error(err);
    statusEl.innerHTML = `<div class="error">Connection failed</div>`;
  }
}

async function disconnectWallet() {
  try { if(provider) await provider.disconnect(); } catch(_) {}
  address = null;
  statusEl.innerHTML = "";
  connectBtn.style.display = "block";
  disconnectBtn.style.display = "none";
}

connectBtn.onclick = connectWallet;
disconnectBtn.onclick = disconnectWallet;
</script>

</body>
</html>
